<!DOCTYPE html>

<html>
    <head>
        <meta charset="utf-8">
        <title>Ride Safe</title>
        <meta name="description" content="Hello, WebVR! � A-Frame">
        <script src="https://aframe.io/releases/0.8.2/aframe.min.js"></script>
        <script src="//cdn.rawgit.com/donmccurdy/aframe-extras/v4.2.0/dist/aframe-extras.min.js"></script>
        <script src="aframe-extras-master/dist/aframe.min.js"></script>
        <script src="../bundle.js"></script>
        <script>


            AFRAME.registerComponent ('collider-check', {
                dependencies: ['raycaster'],

                init: function () {
                    var sceneEl = document.querySelector('a-scene');
                    var scoreBoard = document.querySelector('#score');
                    
                    sceneEl.addEventListener('raycaster-intersected', function () {

                        console.log('Player hit something!');
                        scoreBoard.getAttribute('text').value--;
                        scoreBoard.setAttribute('text', 'value', scoreBoard.getAttribute('text').value);

                    });
                }
            });
        </script>


    </head>

    <a-scene inspector="url:https://aframe.io/releases/0.3.0/aframe-inspector.min.js" background="color:#ECECEC" 
             class="fullscreen" keyboard-shortcuts="" screenshot="" vr-mode-ui="" collider-check>
        <a-assets> 
            <a-mixin id="checkpoint"></a-mixin>
            <a-mixin id="checkpoint-hovered" color="#6CEEB5"></a-mixin>

            <a-assets-item id="tree1" src="models\tree1.ply"></a-assets-item> 
            <a-assets-item id="house1a" src="models\house1a.ply"></a-assets-item> 
            <a-assets-item id="house2" src="models\house2.ply"></a-assets-item> 
            <a-assets-item id="house3a" src="models\house3a.ply"></a-assets-item> 
            <a-assets-item id="scene_house6" src="models\scene_house6.ply"></a-assets-item> 
            <a-assets-item id="playground1" src="models\playground1.ply"></a-assets-item>
            <a-assets-item id="playground2" src="models\playground2.ply"></a-assets-item> 
            <a-assets-item id="playground3" src="models\playground3.ply"></a-assets-item> 
            <a-assets-item id="playground4" src="models\playground4.ply"></a-assets-item> 	  
            <a-assets-item id="playground5" src="models\playground5.ply"></a-assets-item> 
            <a-assets-item id="scene_park4" src="models\scene_park4.ply"></a-assets-item> 
            <a-assets-item id="hdb" src="models\hdb.ply"></a-assets-item> 
            <a-assets-item id="hdb1" src="models\hdb1.ply"></a-assets-item> 

            <a-assets-item id="chr_lady1" src="models\chr_lady1.ply"></a-assets-item> 
            <a-assets-item id="chr_oldlady" src="models\chr_oldlady.ply"></a-assets-item> 
            <a-assets-item id="chr_oldman" src="models\chr_oldman.ply"></a-assets-item> 
            <a-assets-item id="chr_headphones" src="models\chr_headphones.ply"></a-assets-item> 

            <a-assets-item id="rubbish" src="models\rubbish.ply"></a-assets-item> 
            <a-assets-item id="cab1" src="models\cab1.ply"></a-assets-item> 
            <a-assets-item id="car1" src="models\car1.ply"></a-assets-item> 
            <a-assets-item id="car5" src="models\car5.ply"></a-assets-item> 
            <a-assets-item id="truck1" src="models\truck1.ply"></a-assets-item> 
            <a-assets-item id="bus" src="models\bus.ply"></a-assets-item> 
            <a-assets-item id="busstop" src="models\busstop.ply"></a-assets-item> 
            <a-assets-item id="traffic_light" src="models\traffic_light.ply"></a-assets-item>
            <a-asset-item id="bicycle" src="models\bicycle.ply"></a-asset-item>



        </a-assets>

        <!-- Player -->
        <a-entity position="-7.5 0 25" id="rig" movement-controls="controls: checkpoint" checkpoint-controls="mode: animate ">
            <a-entity camera
                      position="0 1.6 0"
                      look-controls="pointerLockEnabled: true">
                <a-sphere raycaster="objects: .collidable; far: 0.4" geometry="radius:0.5"></a-sphere>
                <a-entity raycaster="objects: .collidable; far: 0.4" rotation="0 90 0"></a-entity>
                <a-entity raycaster="objects: .collidable; far: 0.4" rotation="0 270 0"></a-entity>

                <a-entity cursor
                          position="0 0 -1"
                          geometry="primitive: ring; radiusInner: 0.02; radiusOuter: 0.03;"
                          material="color: #CCC; shader: flat;"></a-entity>
                <a-entity ply-model="src:#bicycle" position="0 -2.5  -0.5" scale="0.1 0.1 0.1" rotation="-90 90 0"></a-entity>
                <a-entity id="score" text="value:100000" position="1.5 0.75 -1"></a-entity>
            </a-entity>

        </a-entity>

        <!-- Checkpoints -->
        <a-entity position="1 0 -10">
            <a-cylinder class="collidable" checkpoint="" radius="1" height="5" position="-8.45 0 18.77" color="#E6FF00" material="color:#E6FF00;opacity:0.5;transparent:true" geometry="primitive:cylinder;radius:1;height:5"></a-cylinder>
            <a-cylinder class="collidable" checkpoint="" radius="1" height="5" position="-5.68 0 10.99" color="#FFFFFF" material="color:#E6FF00;opacity:0.5;transparent:true" geometry="primitive:cylinder;radius:1;height:5"></a-cylinder>
            <a-cylinder class="collidable" checkpoint="" radius="1" height="5" position="-8.45 0 -8.64" color="#FFFFFF" material="color:#E6FF00;opacity:0.5;transparent:true" geometry="primitive:cylinder;radius:1;height:5"></a-cylinder>
            <a-cylinder class="collidable" checkpoint="" radius="1" height="5" position="-8.14 0 -23.57" color="#FFFFFF" material="color:#E6FF00;opacity:0.5;transparent:true" geometry="primitive:cylinder;radius:1;height:5"></a-cylinder>
        </a-entity>


        <a-sky src="img\background.jpg" material="" geometry="" scale="" position=""></a-sky>
        <a-plane src="img\textures\grass.jpg" repeat="15 30" position="0 0 -4" rotation="-90 0 0" width="80" height="80" shadow="" material="" geometry=""></a-plane>
        <a-plane src="img\textures\sgroad.jpg" repeat="2 100" position="-2 0.1 -4" rotation="-90 0 0" width="10" height="80" shadow="" material="" geometry=""></a-plane>
        <a-plane src="img\textures\sgroad.jpg" repeat="2 50" position="-23.40 0.1 -17" rotation="-90 90 0" width="10" height="33" shadow="" material="" geometry=""></a-plane>
        <a-plane src="img\textures\sgroad.jpg" repeat="2 50" position="22 0.1 -17" rotation="-90 90 0" width="10" height="38" shadow="" material="" geometry=""></a-plane>
        <a-plane src="img\textures\zebra.jpg" repeat="3 1" position="-2.02 0.2 7.15" rotation="-90 0 0" width="9.82" height="4" shadow="" material=""></a-plane>

        <!-- texts-->
        <a-entity position="-4.07 2.04 0" geometry="primitive:plane;height:0.5;width:2" material="color:red" text="width:2;value:Wet ground reduces traction and painted surfaces worsens the effect. Slowdown early and avoid making sharp turns under such conditions.;zOffset:0"> </a-entity>
        <a-entity position="-6.33 2 -20.24" geometry="primitive:plane;height:0.5;width:2" material="color:red" text="width:2;value:Obey traffic light rules even when there is nobody in sight. Keep left and do not block fast moving cars.;zOffset:0"> </a-entity>
        <a-entity position="-7.82 2 7.41" geometry="primitive:plane;height:0.5;width:2" material="color:red" text="width:2;value:Proceed to next check point after elderly crosses the zebra crossing on the right side.;zOffset:0"> </a-entity>
        <a-entity position="-7.82 2.5 7.41" geometry="primitive:plane;height:0.5;width:2" material="color:red" text="width:2;value:Slow down and prepare to stop at bus stops as passengers will board or alight from bus.;zOffset:0"> </a-entity>
        <a-entity position="-7.41 2.04 23" geometry="primitive:plane;height:0.5;width:2" material="color:red" text="width:2;value:Look at the checkpoint up ahead to move there.;zOffset:0"> </a-entity>

        <!-- houses-->
        <a-entity ply-model="src:#hdb1" position="-15 0 8" scale="0.1 0.1 0.1" rotation="-90 90 0"></a-entity>
        <a-entity ply-model="src:#hdb1" position="-15 2 8" scale="0.1 0.1 0.1" rotation="-90 90 0"></a-entity>
        <a-entity ply-model="src:#hdb1" position="-15 4 8" scale="0.1 0.1 0.1" rotation="-90 90 0"></a-entity>
        <a-entity ply-model="src:#hdb1" position="-15 6 8" scale="0.1 0.1 0.1" rotation="-90 90 0"></a-entity>
        <a-entity ply-model="src:#hdb1" position="-15 8 8" scale="0.1 0.1 0.1" rotation="-90 90 0"></a-entity>
        <a-entity ply-model="src:#hdb1" position="-15 10 8" scale="0.1 0.1 0.1" rotation="-90 90 0"></a-entity>

        <a-entity ply-model="src: #hdb1" position="-15 0 -0" scale="0.1 0.1 0.1" rotation="-90 90 0"></a-entity>
        <a-entity ply-model="src: #hdb1" position="-15 2 -0" scale="0.1 0.1 0.1" rotation="-90 90 0"></a-entity>
        <a-entity ply-model="src: #hdb1" position="-15 4 -0" scale="0.1 0.1 0.1" rotation="-90 90 0"></a-entity>
        <a-entity ply-model="src: #hdb1" position="-15 6 -0" scale="0.1 0.1 0.1" rotation="-90 90 0"></a-entity>
        <a-entity ply-model="src: #hdb1" position="-15 8 -0" scale="0.1 0.1 0.1" rotation="-90 90 0"></a-entity>
        <a-entity ply-model="src: #hdb1" position="-15 10 -0" scale="0.1 0.1 0.1" rotation="-90 90 0"></a-entity>

        <a-entity ply-model="src:#hdb1" position="-15 0 -7" scale="0.1 0.1 0.1" rotation="-90 90 0"></a-entity>
        <a-entity ply-model="src:#hdb1" position="-15 2 -7" scale="0.1 0.1 0.1" rotation="-90 90 0"></a-entity>
        <a-entity ply-model="src:#hdb1" position="-15 4 -7" scale="0.1 0.1 0.1" rotation="-90 90 0"></a-entity>
        <a-entity ply-model="src:#hdb1" position="-15 6 -7" scale="0.1 0.1 0.1" rotation="-90 90 0"></a-entity>
        <a-entity ply-model="src:#hdb1" position="-15 8 -7" scale="0.1 0.1 0.1" rotation="-90 90 0"></a-entity>
        <a-entity ply-model="src:#hdb1" position="-15 10 -7" scale="0.1 0.1 0.1" rotation="-90 90 0"></a-entity>

        <a-entity ply-model="src:#hdb1" position="-15 0 -26.07" scale="0.1 0.1 0.1" rotation="-90 90 0"></a-entity>
        <a-entity ply-model="src:#hdb1" position="-15 2 -26.07" scale="0.1 0.1 0.1" rotation="-90 90 0"></a-entity>
        <a-entity ply-model="src:#hdb1" position="-15 4 -26.07" scale="0.1 0.1 0.1" rotation="-90 90 0"></a-entity>
        <a-entity ply-model="src:#hdb1" position="-15 6 -26.07" scale="0.1 0.1 0.1" rotation="-90 90 0"></a-entity>
        <a-entity ply-model="src:#hdb1" position="-15 8 -26.07" scale="0.1 0.1 0.1" rotation="-90 90 0"></a-entity>
        <a-entity ply-model="src:#hdb1" position="-15 10 -26.07" scale="0.1 0.1 0.1" rotation="-90 90 0"></a-entity>


        <a-entity ply-model="src:#hdb" position="9.11 0 -30.18" scale="0.1 0.1 0.1" rotation="-90 0 0"></a-entity>
        <a-entity ply-model="src:#hdb" position="9.11 2 -30.18" scale="0.1 0.1 0.1" rotation="-90 0 0"></a-entity>
        <a-entity ply-model="src:#hdb" position="9.11 4 -30.18" scale="0.1 0.1 0.1" rotation="-90 0 0"></a-entity>
        <a-entity ply-model="src:#hdb" position="9.11 6 -30.18" scale="0.1 0.1 0.1" rotation="-90 0 0"></a-entity>
        <a-entity ply-model="src:#hdb" position="9.11 8 -30.18" scale="0.1 0.1 0.1" rotation="-90 0 0"></a-entity>

        <a-entity ply-model="src:#hdb" position="20 0 -30.24" scale="0.1 0.1 0.1" rotation="-90 0 0"></a-entity>
        <a-entity ply-model="src:#hdb" position="20 2 -30.24" scale="0.1 0.1 0.1" rotation="-90 0 0"></a-entity>
        <a-entity ply-model="src:#hdb" position="20 4 -30.24" scale="0.1 0.1 0.1" rotation="-90 0 0"></a-entity>
        <a-entity ply-model="src:#hdb" position="20 6 -30.24" scale="0.1 0.1 0.1" rotation="-90 0 0"></a-entity>
        <a-entity ply-model="src:#hdb" position="20 8 -30.24" scale="0.1 0.1 0.1" rotation="-90 0 0"></a-entity>

        <a-entity ply-model="src:#hdb" position="28 0 -30.24" scale="0.1 0.1 0.1" rotation="-90 0 0"></a-entity>
        <a-entity ply-model="src:#hdb" position="28 2 -30.24" scale="0.1 0.1 0.1" rotation="-90 0 0"></a-entity>
        <a-entity ply-model="src:#hdb" position="28 4 -30.24" scale="0.1 0.1 0.1" rotation="-90 0 0"></a-entity>
        <a-entity ply-model="src:#hdb" position="28 6 -30.24" scale="0.1 0.1 0.1" rotation="-90 0 0"></a-entity>
        <a-entity ply-model="src:#hdb" position="28 8 -30.24" scale="0.1 0.1 0.1" rotation="-90 0 0"></a-entity>

        <a-entity ply-model="src:#house2" position="-19.7 0 19.61" scale="0.2 0.2 0.2" rotation="-90 90 0"></a-entity>
        <a-entity ply-model="src:#house2" position="21.71 0 -5.31" scale="0.2 0.2 0.2" rotation="-90 90 0"></a-entity>
        <a-entity ply-model="src:#house2" position="21.71 0 21.55" scale="0.2 0.2 0.2" rotation="-90 90 0"></a-entity>

        <!-- left trees -->
        <a-entity ply-model="src:#tree1" position="-8.46 0 -40" scale="0.1 0.1 0.1" rotation="-90 0 0"></a-entity>
        <a-entity ply-model="src:#tree1" position="-8.46 0 -35" scale="0.1 0.1 0.1" rotation="-90 0 0"></a-entity>
        <a-entity ply-model="src:#tree1" position="-8.46 0 -30" scale="0.1 0.1 0.1" rotation="-90 0 0"></a-entity>
        <a-entity ply-model="src:#tree1" position="-8.46 0 -25" scale="0.1 0.1 0.1" rotation="-90 0 0"></a-entity>
        <a-entity ply-model="src:#tree1" position="-8.46 0 -10" scale="0.1 0.1 0.1" rotation="-90 0 0"></a-entity>
        <a-entity ply-model="src:#tree1" position="-8.46 0 -5" scale="0.1 0.1 0.1" rotation="-90 0 0"></a-entity>
        <a-entity ply-model="src:#tree1" position="-8.46 0 0" scale="0.1 0.1 0.1" rotation="-90 0 0"></a-entity>
        <a-entity ply-model="src:#tree1" position="-8.46 0 5" scale="0.1 0.1 0.1" rotation="-90 0 0"></a-entity>
        <a-entity ply-model="src:#tree1" position="-8.46 0 10" scale="0.1 0.1 0.1" rotation="-90 0 0"></a-entity>
        <a-entity ply-model="src:#tree1" position="-8.46 0 15" scale="0.1 0.1 0.1" rotation="-90 0 0"></a-entity>
        <a-entity ply-model="src:#tree1" position="-8.46 0 20" scale="0.1 0.1 0.1" rotation="-90 0 0"></a-entity>
        <a-entity ply-model="src:#tree1" position="-8.46 0 25" scale="0.1 0.1 0.1" rotation="-90 0 0"></a-entity>

        <!-- right trees -->
        <a-entity ply-model="src:#tree1" position="5.10 0 -40" scale="0.1 0.1 0.1" rotation="-90 0 0"></a-entity>
        <a-entity ply-model="src:#tree1" position="5.10 0 -35" scale="0.1 0.1 0.1" rotation="-90 0 0"></a-entity>
        <a-entity ply-model="src:#tree1" position="5.10 0 -30" scale="0.1 0.1 0.1" rotation="-90 0 0"></a-entity>
        <a-entity ply-model="src:#tree1" position="5.10 0 -25" scale="0.1 0.1 0.1" rotation="-90 0 0"></a-entity>
        <a-entity ply-model="src:#tree1" position="5.10 0 -10" scale="0.1 0.1 0.1" rotation="-90 0 0"></a-entity>
        <a-entity ply-model="src:#tree1" position="5.10 0 -5" scale="0.1 0.1 0.1" rotation="-90 0 0"></a-entity>
        <a-entity ply-model="src:#tree1" position="5.10 0 0" scale="0.1 0.1 0.1" rotation="-90 0 0"></a-entity>
        <a-entity ply-model="src:#tree1" position="5.10 0 15" scale="0.1 0.1 0.1" rotation="-90 0 0"></a-entity>
        <a-entity ply-model="src:#tree1" position="5.10 0 20" scale="0.1 0.1 0.1" rotation="-90 0 0"></a-entity>
        <a-entity ply-model="src:#tree1" position="5.10 0 25" scale="0.1 0.1 0.1" rotation="-90 0 0"></a-entity>

        <!-- objects and humans -->
        <a-entity ply-model="src:#chr_lady1" position="-9.74 0 2.14" scale="0.1 0.1 0.1" rotation="-90 90 0">
            <a-animation attribute="position" dur="5000" from="-9.74 0 2.14" to="-6 0 2.95" repeat="0" begin="13000" ></a-animation>
            <a-animation attribute="position" dur="10" from="-6 0 2.95" to="-6 -100 2.95" repeat="0" begin="20000" ></a-animation>
        </a-entity>
        <a-entity ply-model="src:#chr_oldman" position="4.17 0 8.27" scale="0.1 0.1 0.1" rotation="-90 270 0">
            <a-animation attribute="position" dur="30000" from="4.17 0 8.27" to="-13 0 8.27" repeat="0" begin="12000" ></a-animation>
        </a-entity>
        <a-entity ply-model="src:#chr_oldlady" position="4.06 0 6.97" scale="0.1 0.1 0.1" rotation="-90 270 0">
            <a-animation attribute="position" dur="30000" from="4.06 0 6.97" to="-13 0 7" repeat="0" begin="12000" ></a-animation>
        </a-entity>
        <a-entity ply-model="src:#traffic_light" position="-2.09 0 -17.21" scale="0.1 0.1 0.1" rotation="-90 0 0"></a-entity>
        <a-entity position="-3.64 0.2 0.47" rotation="-90 90 0" material="color:#0000FF;flatShading:true;opacity:0.3" geometry="primitive:circle;radius: 2"> </a-entity>


        <!-- vehicles -->
        <a-entity ply-model="src:#car1" position="-5.4 -0.01 -10.09" scale="0.1 0.1 0.1" rotation="-90 0 0">
            <a-animation attribute="position" dur="10000" from="-5.4 -0.01 -10.09" to="-5.4 -0.01 -42.34" repeat="0" begin="25000" ></a-animation>
        </a-entity>
        <a-entity ply-model="src:#car1" position="-3.4 -0.01 -10.09" scale="0.1 0.1 0.1" rotation="-90 0 0">
            <a-animation attribute="position" dur="10000" from="-3.4 -0.01 -10.09" to="-3.4 -0.01 -42.34" repeat="0" begin="25000" ></a-animation>
        </a-entity>
        <a-entity ply-model="src:#cab1" position="-2.94 0 34" scale="0.1 0.1 0.1" rotation="-90 0 0">
            <a-animation attribute="position" dur="7000" from="-2.94 0 41.66" to="-3 -0.01 -40.34" repeat="indefinite" begin="30000" ></a-animation>
        </a-entity>

        <a-entity ply-model="src:#car5" position="17.18 0 -13.54" scale="0.1 0.1 0.1" rotation="-90 90 0">
            <a-animation attribute="position" dur="10000" from="17.18 0 -13.54" to="-35 0 -13.54" repeat="0" begin="5000" ></a-animation>
        </a-entity>
        <a-entity ply-model="src:#car5" position="4.64 0 -13.54" scale="0.1 0.1 0.1" rotation="-90 90 0">
            <a-animation attribute="position" dur="5000" from="4.64 0 -13.54" to="-40 0 -13" repeat="0"  begin="5000"></a-animation>
        </a-entity>
        <a-entity ply-model="src:#busstop" position="-9.77 0 2.95" scale="0.1 0.1 0.1" rotation="-90 90 0"></a-entity>
        <a-entity ply-model="src:#bus" scale="0.1 0.1 0.1" rotation="-90 0 0">
            <a-animation attribute="position" dur="20000" from="-5.47 0 15.54" to="-5.47 0 2.95" repeat="0"  ></a-animation>
            <a-animation attribute="position" dur="15000" from="-5.47 0 2.95" to="-5.47 0 -37" repeat="0" begin="20000" ></a-animation>
        </a-entity>  

    </a-scene>


</html

<!�positioning is  left right, up down, forward backward�>
